---
title: "DArT_Report2VCF_par"
output: html_document
date: "2024-08-29"
---

* **DArT MADC File**

The DArT MADC (Missing Allele Discovery Counts) file is a comma-separated file provided by DArT from a sequencing project. It includes the following key columns:

* AlleleID: Typically contains the chromosome, position, reference or alternative allele designation, and the allele ID according to the haplotype database (e.g., Chr01_000084128|Ref_0001).
* CloneID: Represents the chromosome and position (e.g., Chr01_000084128).
*	AlleleSequence: The amplicon sequence (e.g., GAGTGTGAAGATTTGGACAAAAGAGGTTGGTTTTTACTGTTATGGCATTTATCTCCTTATAAAATTTTGTATTTTTTTTGT).
*	Sample Columns: Named with sample IDs and containing counts of each allele per sample.

**Important**: BIGapp requires fixed AlleleIDs tagged with a respective number (e.g., suffix: _0001). Fixed AlleleIDs are generated by matching the MADC contents to the haplotype database. If your MADC file does not contain fixed AlleleIDs, please contact Breeding Insight.


* **Target vs. Off-Target SNPs**

If you provide a MADC file, you can choose between extracting:

* Only target SNPs – These are the SNPs for which probes were specifically designed. If your panel includes 3,000 SNPs, your output VCF file should contain exactly 3,000 target SNPs.
* Both target and off-target SNPs – In addition to target SNPs, BIGapp will identify other SNPs within the amplicon region.

To identify off-target SNPs, BIGapp performs a pairwise alignment between each sequence and its reference using the Bioconductor packages Biostrings and pwalign.

This option requires the following additional files:
* Haplotype database (.fa)
* Bottom strand loci (.botloci)

If you do not have access to these files, please contact Breeding Insight.

You can also input **multiple MADC files**. BIGapp will merge the files before the conversion. If you have repeated samples IDs, a suffix with the run ID (beginning of the file name) will be added to the repeated samples.


* **DArTag Dosage Report**

The DArT Dosage Report is a tab-separated file provided by DArT from a sequencing project. It contains genotypic information for each target marker across all samples in the sequencing project.

File Structure:

* Markers are in rows, and samples are in columns.
* The file includes several summary metric columns before the sample dosage columns.
* Dosage values represent the number of alternative alleles present in each sample, ranging from 0 to the species’ ploidy number.

Dosage Interpretation (Example: Tetraploid Species - 4x)

* 4 → Homozygous for the reference allele (AAAA)
*	3 → Heterozygous with three reference alleles and one alternative (AAAB)
*	2 → Heterozygous with two reference and two alternative alleles (AABB)
*	1 → Heterozygous with one reference allele and three alternative (ABBB)
*	0 → Homozygous for the alternative allele (BBBB)

This codification is commonly used as input for various software, including AGHmatrix, rrBLUP, and mappoly. However, some programs require not only dosage information but also read counts (see description below).

To accommodate this, BIGapp integrates both dosage and read count data, generating a VCF file—the most widely accepted and standardized format for genotypic information, ensuring compatibility with a broad range of software.

 
* **DArTag Counts File**

The DArT counts file is a tab-separated file provided by DArT from a sequencing project. It contains the read count information for the reference and alternate allele at each target marker. The marker information is in the rows and the samples are in the columns. There are several informational columns that precede the sample columns. There are two versions of this file. The “collapsed counts” version contains the target markers that includes their multiallic read counts in their total counts. The “Counts” file contains the read counts for the target markers only (excluding the multiallelic read count information). BIGapp will merge the counts and the dosage information to generate a VCF file format —the most widely accepted and standardized format for genotypic information, ensuring compatibility with a broad range of software.
 
* **Species Ploidy**

Specifies the ploidy level of the species. The current analysis supports both diploids and autopolyploids. 
